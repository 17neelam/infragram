{"version":3,"sources":["infragram.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","module","urlHash","getUrlHashParameter","param","params","getUrlHashParameters","sPageURL","window","location","hash","split","pairs","object","forEach","pair","setUrlHashParameters","keys","Object","values","key","push","join","setUrlHashParameter","value","Infragram","options","uploader","processor","camera","JsImage","processors","logger","Camera","Dispatch","Interface","Colormaps","greyscale_colormap","segmented_colormap","colormap1","colormap2","segments","x","len","m","ref","result","x0","x1","xstart","y0","y1","colorify","jsImage","colormap","b","data","g","j","$","addClass","width","height","Uint8ClampedArray","Converters","hsv2rgb","h","v","p","q","rgb","Math","floor","rgb2hsv","d","max","min","colorized","mode","video_live","webGlSupported","run_infragrammar","save_log","runInfragrammar","run_colorize","type","imageData","getImageData","render","infragrammar_mono","glHandleOnClickColor","save_infragrammar_inputs","val","save_infragrammar_expressions","args","save_expressions","save_expressions_hsv","FileUpload","socket","file","serverFilename","isLoadedFromFile","getFilename","setFilename","name","uploadThumbnail","src","callback","img","Image","onload","onImageLoad","canvas","ctx","dataUrl","document","createElement","getContext","drawImage","toString","toDataURL","emit","fromFile","files","upload","reader","prop","FileReader","onReaderLoad","event","size","target","uploaded","readAsDataURL","duplicate","fromBase64","initialize","rememberTransport","transports","io","connect","protocol","host","on","newFile","txt","html","round","slice","alert","eval","imageSelector","fileSelector","ready","uploadable","enablewebgl","idNameMap","initialized","JSON","stringify","parametersObject","search","fetch_image","change","show","updateImage","modal","click","glHandleOnClickRaw","glHandleOnSubmitInfraMono","glHandleOnClickNdvi","glhandledefaultcolormap","glhandleonclickndvi","glHandleStretchedColormap","log","jsHandleOnClickRaw","jsHandleOnClickNdvi","jsHandleOnSubmitInfraMono","downloadImage","sendThumbnail","getCurrentImage","submit","log_hsv","glHandleOnSubmitInfraHsv","log_rgb","glHandleOnSubmitInfra","log_mono","glHandleOnClickGrey","jsHandleOnClickGrey","glHandleOnClickColorify","jsHandleOnClickColorify","jsHandleOnClickColor","href","replace","indexOf","setInterval","image","getSnapshot","css","hide","parseInt","innerWidth","tooltip","popover","getUserMedia","webRtcOptions","success","deviceError","videoEl","setAttribute","webcam","getElementById","el","extern","append","debug","onCapture","onWebRtcCapture","save","onSave","onSaveGetUserMedia","onLoad","onLoadGetUserMedia","col","tmp","w","pos","putImageData","stream","vendorURL","video","context","URL","webkitURL","navigator","mozGetUserMedia","mozSrcObject","console","createObjectURL","onerror","stop","error","getElementsByTagName","capture","Logger","logEntry","javascriptProcessor","b_exp","g_exp","get_channels","converters","jsHandleOnSlide","jsHandleOnSubmitInfra","jsHandleOnSubmitInfraHsv","m_exp","ndvi","r_exp","set_mode","update_colorbar","histogram","array","nbins","bins","results","mkImage","Float32Array","nirJsImg","visJsImg","Float64Array","infragrammar","removeClass","copyToImageData","k","ref1","style","display","textContent","toFixed","update","ndvi_jsImg","normalize","resultJsImage","getJsImage","new_mode","imgCanvas","videoWidth","videoHeight","webglProcessor","imgContext","mapContext","vertices","waitForShadersToLoad","webglUtils","itemSize","createContext","load","glShaderLoaded","createBuffer","buffer","gl","bindBuffer","ARRAY_BUFFER","bufferData","STATIC_DRAW","createTexture","textureUnit","texture","activeTexture","bindTexture","TEXTURE_2D","pixelStorei","UNPACK_FLIP_Y_WEBGL","texImage2D","RGBA","UNSIGNED_BYTE","texParameteri","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","TEXTURE_MAG_FILTER","NEAREST","TEXTURE_MIN_FILTER","selColormap","slider","canvasName","expression","updateShader","addEventListener","preventDefault","glRestoreContext","getWebGLContext","getExtension","vertexBuffer","framebuffer","createFramebuffer","imageTexture","TEXTURE0","drawScene","returnImage","pColormap","pHsvUniform","pNdviUniform","pSampler","pSelColormapUniform","pSliderUniform","pVertexPosition","requestAnimationFrame","generateShader","viewport","useProgram","shaderProgram","getAttribLocation","enableVertexAttribArray","vertexAttribPointer","FLOAT","getUniformLocation","uniform1i","uniform1f","drawArrays","TRIANGLE_STRIP","toLowerCase","createProgramFromScripts","setMode","newMode","glHandleDefaultColormap","saveExpression","c","glHandleOnSlide","data1","width1","height1","channels","imgData","set","maxs","mins","msg","loggingOff","isInIFrame","top","glEnumToString","makeFailHTML","GET_A_WEBGL_BROWSER","OTHER_PROBLEM","setupWebGL","opt_attribs","showLink","str","container","parentNode","innerHTML","WebGLRenderingContext","create3DContext","names","ii","updateCSSIfInIFrame","body","className","clientWidth","clientHeight","loadShader","shaderSource","shaderType","opt_errorCallback","errFn","shader","createShader","compileShader","compiled","getShaderParameter","COMPILE_STATUS","lastError","getShaderInfoLog","deleteShader","loadProgram","shaders","opt_locations","program","createProgram","attachShader","bindAttribLocation","linkProgram","linked","getProgramParameter","LINK_STATUS","getProgramInfoLog","deleteProgram","createShaderFromScript","scriptId","opt_shaderType","shaderScript","text","VERTEX_SHADER","FRAGMENT_SHADER","defaultShaderType","shaderScriptIds","browserPrefixes","getExtensionWithKnownPrefixes","prefixedName","ext","resizeCanvasToDisplaySize","requestAnimFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame","element","setTimeout","cancelRequestAnimFrame","cancelCancelRequestAnimationFrame","webkitCancelRequestAnimationFrame","mozCancelRequestAnimationFrame","oCancelRequestAnimationFrame","msCancelRequestAnimationFrame","clearTimeout","createShaderFromScriptElement"],"mappings":"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","file":"infragram.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\nfunction urlHash() {\n\nfunction getUrlHashParameter(param) {\n\n  var params = getUrlHashParameters();\n  return params[param];\n\n}\n\nfunction getUrlHashParameters() {\n\n  var sPageURL = window.location.hash;\n  if (sPageURL) sPageURL = sPageURL.split('#')[1];\n  var pairs = sPageURL.split('&');\n  var object = {};\n  pairs.forEach(function(pair, i) {\n    pair = pair.split('=');\n    if (pair[0] != '') object[pair[0]] = pair[1];\n  });\n  return object;\n}\n\n// accepts an object like { paramName: value, paramName1: value }\n// and transforms to: url.com#paramName=value&paramName1=value\nfunction setUrlHashParameters(params) {\n\n  var keys = Object.keys(params);\n  var values = Object.values(params);\n  var pairs = [];\n  keys.forEach(function(key, i) {\n    if (key != '') pairs.push(keys[i] + '=' + values[i]);\n  });\n  var hash = pairs.join('&');\n  window.location.hash = hash;\n\n}\n\nfunction setUrlHashParameter(param, value) {\n\n  var params = getUrlHashParameters();\n  params[param] = value;\n  setUrlHashParameters(params);\n\n}\n\nreturn {\n  getUrlHashParameter:   getUrlHashParameter,\n  getUrlHashParameters:  getUrlHashParameters,\n  setUrlHashParameter:   setUrlHashParameter,\n  setUrlHashParameters:  setUrlHashParameters\n}\n\n}\n\nmodule.exports = urlHash;\n\n},{}],2:[function(require,module,exports){\nwindow.Infragram = function Infragram(options) {\n  options = options || {};\n  options.uploader = options.uploader || false;\n  options.processor = options.processor || 'javascript';\n  options.camera = require('./io/camera')(options);\n\n  var JsImage = require('./util/JsImage.js');\n\n  options.processors = {\n    'webgl':           require('./processors/webgl'),\n    'javascript':      require('./processors/javascript'),\n  }\n\n  options.processor = options.processors[options.processor]();\n  options.logger = require('./logger')(options);\n\n  return {\n    Camera: options.camera,\n    Dispatch: require('./dispatch')(options, options.processor),\n    Interface: require('./interface')(options),\n    logger: options.logger,\n    processors: options.processors\n  }\n}\nmodule.exports = Infragram;\n\n},{\"./dispatch\":5,\"./interface\":7,\"./io/camera\":8,\"./logger\":9,\"./processors/javascript\":10,\"./processors/webgl\":11,\"./util/JsImage.js\":12}],3:[function(require,module,exports){\n// This file was adapted from infragram-js:\n// http://github.com/p-v-o-s/infragram-js.\n\nmodule.exports = function Colormaps(options) {\n\n  var greyscale_colormap = segmented_colormap([[0, [0,   0,   0  ], [255, 255, 255]], \n                                               [1, [255, 255, 255], [255, 255, 255]]]);\n\n  var colormap1 = segmented_colormap([[0,    [0,   0,   255], [38,  195, 195]],\n                                      [0.5,  [0,   150, 0  ], [255, 255, 0  ]],\n                                      [0.75, [255, 255, 0  ], [255, 50,  50 ]]]);\n\n  var colormap2 = segmented_colormap([[0,   [0,   0,   255], [0,   0,   255]], \n                                      [0.1, [0,   0,   255], [38,  195, 195]],\n                                      [0.5, [0,   150, 0  ], [255, 255, 0  ]],\n                                      [0.7, [255, 255, 0  ], [255, 50,  50 ]],\n                                      [0.9, [255, 50,  50 ], [255, 50,  50 ]]]);\n\n  function segmented_colormap(segments) {\n    return function(x) {\n      var i, l, len, m, ref, result, x0, x1, xstart, y0, y1;\n      [y0, y1] = [0, 0];\n      [x0, x1] = [segments[0][0], 1];\n      if (x < x0) {\n        return y0;\n      }\n      for (i = l = 0, len = segments.length; l < len; i = ++l) {\n        [xstart, y0, y1] = segments[i];\n        x0 = xstart;\n        if (i === segments.length - 1) {\n          x1 = 1;\n          break;\n        }\n        x1 = segments[i + 1][0];\n        if ((xstart <= x && x < x1)) {\n          break;\n        }\n      }\n      result = [];\n      for (i = m = 0, ref = y0.length; 0 <= ref ? m < ref : m > ref; i = 0 <= ref ? ++m : --m) {\n        result[i] = (x - x0) / (x1 - x0) * (y1[i] - y0[i]) + y0[i];\n      }\n      return result;\n    }\n  }\n\n  function colorify(jsImage, colormap) {\n    var b, data, g, i, j, l, n, r, ref;\n    $('#btn-colorize').addClass('active');\n    n = jsImage.width * jsImage.height;\n    data = new Uint8ClampedArray(4 * n);\n    j = 0;\n    for (i = l = 0, ref = n; 0 <= ref ? l < ref : l > ref; i = 0 <= ref ? ++l : --l) {\n      [r, g, b] = colormap(jsImage.data[i]);\n      data[j++] = r;\n      data[j++] = g;\n      data[j++] = b;\n      data[j++] = 255;\n    }\n    return new JsImage(data, jsImage.width, jsImage.height, 4);\n  }\n\n  return {\n    colorify: colorify,\n    colormap1: colormap1,\n    colormap2: colormap2,\n    greyscale_colormap: greyscale_colormap,\n    segmented_colormap: segmented_colormap\n  }\n\n}\n\n},{}],4:[function(require,module,exports){\n// This file was adapted from infragram-js:\n// http://github.com/p-v-o-s/infragram-js.\n\nmodule.exports = Converters = {\n\n  // modified from:\n  // http://axonflux.com/handy-rgb-to-hsl-and-rgb-to-hsv-color-model-c\n  hsv2rgb: function hsv2rgb(h, s, v) {\n    var data, f, i, p, q, rgb, t;\n    data = [];\n    if (s === 0) {\n      rgb = [v, v, v];\n    } else {\n      i = Math.floor(h * 6);\n      f = h * 6 - i;\n      p = v * (1 - s);\n      q = v * (1 - f * s);\n      t = v * (1 - (1 - f) * s);\n      data = [v * (1 - s), v * (1 - s * (h - i)), v * (1 - s * (1 - (h - i)))];\n      switch (i) {\n        case 0:\n          rgb = [v, t, p];\n          break;\n        case 1:\n          rgb = [q, v, p];\n          break;\n        case 2:\n          rgb = [p, v, t];\n          break;\n        case 3:\n          rgb = [p, q, v];\n          break;\n        case 4:\n          rgb = [t, p, v];\n          break;\n        default:\n          rgb = [v, p, q];\n      }\n    }\n    return rgb;\n  },\n\n  rgb2hsv: function rgb2hsv(r, g, b) {\n    var d, h, max, min, s, v;\n    max = Math.max(r, g, b);\n    min = Math.min(r, g, b);\n    h = s = v = max;\n    d = max - min;\n    s = max === 0 ? 0 : d / max;\n    if (max === min) {\n      h = 0; // achromatic\n    } else {\n      switch (max) {\n        case r:\n          h = (g - b) / d + (g < b ? 6 : 0);\n          break;\n        case g:\n          h = (b - r) / d + 2;\n          break;\n        case b:\n          h = (r - g) / d + 4;\n      }\n      h /= 6;\n    }\n    return [h, s, v];\n  }\n\n}\n\n},{}],5:[function(require,module,exports){\n// This file was adapted from infragram-js:\n// http://github.com/p-v-o-s/infragram-js.\n\nmodule.exports = function Dispatch(options, processor) {\n\n  options.colorized      = options.colorized      || false;\n  options.mode           = options.mode           || \"raw\",\n  options.video_live     = options.video_live     || false,\n  options.webGlSupported = options.webGlSupported || false; // move into processor\n\n  var Colormaps = require('./color/colormaps')();\n\n  var logger = options.logger;\n\n  // this should accept an object with parameters r,g,b,h,s,v,m and mode\n  options.run_infragrammar = function run_infragrammar(mode) {\n    logger.save_log();\n    options.colorized = false;\n    return processor.runInfragrammar(mode);\n  }\n\n  // this maps -1-1 to 0-1, i guess\n  options.run_colorize = function run_colorize() {\n    // not needed for webgl -- but then we should refactor this \n    // to be within the JS processor if it's not universally \n    // part of the processor API\n    if (processor.type !== 'webgl') {\n      var imageData = processor.getImageData();\n      processor.render(Colormaps.colorify(processor.infragrammar_mono(imageData), function(x) {\n        return processor.colormap((x + 1) / 2);\n      }));\n      return true;\n    } else {\n      processor.glHandleOnClickColor();\n    }\n  }\n\n  // saving inputs/expressions:\n\n  // can we move this into interface?\n  options.save_infragrammar_inputs = function save_infragrammar_inputs() {\n    options.mode = $('#modeSwitcher').val();\n    return options.save_infragrammar_expressions({\n      'r': $('#r_exp').val(),\n      'g': $('#g_exp').val(),\n      'b': $('#b_exp').val(),\n      'm': $('#m_exp').val(),\n      'h': $('#h_exp').val(),\n      's': $('#s_exp').val(),\n      'v': $('#v_exp').val()\n    });\n  }\n\n  options.save_infragrammar_expressions = function save_infragrammar_expressions(args) {\n    if (options.mode === \"infragrammar\") {\n      processor.save_expressions(args['r'], args['g'], args['b']);\n    } else if (options.mode === \"infragrammar_mono\") {\n      processor.save_expressions(args['m'], args['m'], args['m']);\n    } else if (options.mode === \"infragrammar_hsv\") {\n      return processor.save_expressions_hsv(args['h'], args['s'], args['v']);\n    }\n  }\n\n  return {\n    options: options,\n    run_colorize: options.run_colorize,\n    run_infragrammar: options.run_infragrammar,\n    save_infragrammar_expressions: options.save_infragrammar_expressions,\n    save_infragrammar_inputs: options.save_infragrammar_inputs\n  }\n\n}\n\n},{\"./color/colormaps\":3}],6:[function(require,module,exports){\n// Generated by CoffeeScript 2.1.0\n// This file was adapted from infragram-js:\n// http://github.com/p-v-o-s/infragram-js.\nmodule.exports = window.FileUpload = {\n\n  socket: null,\n  file: null,\n  serverFilename: \"\",\n\n  isLoadedFromFile: function() {\n    if (FileUpload.file) {\n      return true;\n    } else {\n      return false;\n    }\n  },\n\n  getFilename: function() {\n    return FileUpload.serverFilename;\n  },\n\n  setFilename: function(name) {\n    return FileUpload.serverFilename = name;\n  },\n\n  uploadThumbnail: function(src, callback) {\n    var img;\n    img = new Image();\n    img.onload = function onImageLoad() {\n      var canvas, ctx, dataUrl;\n      canvas = document.createElement(\"canvas\");\n      ctx = canvas.getContext(\"2d\");\n      canvas.width = 260;\n      canvas.height = 195;\n      ctx.drawImage(this, 0, 0, this.width, this.height, 0, 0, canvas.width, canvas.height);\n      callback = callback.toString();\n      dataUrl = canvas.toDataURL(\"image/jpeg\");\n      return FileUpload.socket.emit(\"thumbnail_start\", {\n        \"name\": FileUpload.serverFilename,\n        \"data\": dataUrl,\n        \"callback\": callback\n      });\n    };\n    return img.src = src;\n  },\n\n  fromFile: function(files, callback, upload) {\n    var reader;\n    if (files && files[0]) {\n      $(\"#file-sel\").prop(\"disabled\", true);\n      $(\"#save-modal-btn\").prop(\"disabled\", true);\n      FileUpload.file = files[0];\n      FileUpload.file.reader = new FileReader();\n      if (upload) {\n        FileUpload.file.reader.onload = function onReaderLoad(event) {\n          return FileUpload.socket.emit(\"image_send\", {\n            \"name\": FileUpload.serverFilename,\n            \"size\": FileUpload.file.size,\n            \"data\": event.target.result\n          });\n        };\n        FileUpload.socket.emit(\"image_send\", {\n          \"name\": files[0].name,\n          \"size\": files[0].size\n        });\n      }\n      FileUpload.file.uploaded = 0;\n      reader = new FileReader();\n      reader.onload = function onReaderLoad(event) {\n        var img;\n        img = new Image();\n        img.onload = function onImageLoad() {\n          return callback(this);\n        };\n        return img.src = event.target.result;\n      };\n      return reader.readAsDataURL(files[0]);\n    }\n  },\n\n  duplicate: function(callback) {\n    callback = callback.toString();\n    return FileUpload.socket.emit(\"duplicate_start\", {\n      \"name\": FileUpload.serverFilename,\n      \"callback\": callback\n    });\n  },\n\n  fromBase64: function(name, data, callback) {\n    callback = callback.toString();\n    return FileUpload.socket.emit(\"base64_start\", {\n      \"name\": name,\n      \"data\": data,\n      \"callback\": callback\n    });\n  },\n\n  initialize: function(options) {\n    options = options || {};\n    options.rememberTransport = options.rememberTransport || false;\n    options.transports = options.transports || ['websocket', 'AJAX long-polling'];\n\n    if (options.socket) {\n      FileUpload.socket = io.connect(window.location.protocol + \"//\" + window.location.host, options);\n      FileUpload.socket.on(\"image_request\", function(data) {\n        var file, newFile, txt;\n        file = FileUpload.file;\n        txt = $(\"#save-modal-btn\").html().split(/\\s-\\s/g)[0];\n        txt += \" - \" + Math.round((file.uploaded / file.size) * 100) + \"%\";\n        $(\"#save-modal-btn\").html(txt);\n        newFile = file.slice(file.uploaded, file.uploaded + Math.min(data[\"chunk\"], file.size - file.uploaded));\n        FileUpload.file.uploaded += data[\"chunk\"];\n        FileUpload.serverFilename = data[\"name\"];\n        return file.reader.readAsDataURL(newFile);\n      });\n      FileUpload.socket.on(\"image_done\", function(data) {\n        var txt;\n        if (data[\"error\"]) {\n          alert(data[\"error\"]);\n        } else {\n          FileUpload.serverFilename = data[\"name\"];\n        }\n        txt = $(\"#save-modal-btn\").html().split(/\\s-\\s/g)[0];\n        $(\"#save-modal-btn\").html(txt);\n        $(\"#file-sel\").prop(\"disabled\", false);\n        return $(\"#save-modal-btn\").prop(\"disabled\", false);\n      });\n      FileUpload.socket.on(\"base64_done\", function(data) {\n        FileUpload.serverFilename = data[\"name\"];\n        eval(\"var callback=\" + data[\"callback\"]);\n        return callback();\n      });\n      FileUpload.socket.on(\"duplicate_done\", function(data) {\n        if (data[\"error\"]) {\n          return alert(data[\"error\"]);\n        } else {\n          FileUpload.serverFilename = data[\"name\"];\n          eval(\"var callback=\" + data[\"callback\"]);\n          return callback();\n        }\n      });\n      FileUpload.socket.on(\"thumbnail_done\", function(data) {\n        eval(\"var callback=\" + data[\"callback\"]);\n        return callback();\n      });\n    }\n\n  }\n}\n\n},{}],7:[function(require,module,exports){\nmodule.exports = function Interface(options) {\n\n  options.imageSelector = options.imageSelector || \"#image-container\";\n  options.fileSelector = options.fileSelector || \"#file-sel\";\n\n  var urlHash = require('urlhash')();\n  var FileUpload = require('./file-upload');\n  var logger = options.logger;\n  var Colormaps = require('./color/colormaps');\n\n  $(document).ready(function() {\n\n    if (options.uploadable) FileUpload.initialize({ socket: options.uploadable });\n\n    $(options.imageSelector).ready(function() {\n      var enablewebgl, idNameMap, src;\n      enablewebgl = urlHash.getUrlHashParameter(\"webgl\") === \"true\" ? true : false;\n      var initialized = options.processor.initialize && options.processor.initialize();\n      options.webGlSupported = enablewebgl && initialized;\n\n      if (options.webGlSupported) {\n        $(\"#webgl-activate\").html(\"&laquo; Go back to JS version\");\n      }\n\n      // broken:  \n      idNameMap = {\n        \"#m_exp\": \"m\",\n        \"#r_exp\": \"r\",\n        \"#g_exp\": \"g\",\n        \"#b_exp\": \"b\",\n        \"#h_exp\": \"h\",\n        \"#s_exp\": \"s\",\n        \"#v_exp\": \"v\"\n      };\n\n      urlHash.setUrlHashParameter(JSON.stringify(idNameMap));\n      src = urlHash.getUrlHashParameter('src');\n      if (src) {\n        params = parametersObject(location.search.split('?')[1]);\n        options.mode = params['mode'];\n        fetch_image(src);\n      }\n      return true;\n    });\n\n    $(options.fileSelector).change(function() {\n      $(\"#save-modal-btn\").show();\n      $(\"#save-zone\").show();\n      FileUpload.fromFile(this.files, options.processor.updateImage, options.uploadable);\n      $('#preset-modal').modal('show');\n      return true;\n    });\n\n    $(\"#preset_raw\").click(function() {\n      $('#modeSwitcher').val(\"infragrammar\").change();\n      $('#r_exp').val(\"R\");\n      $('#g_exp').val(\"G\");\n      $('#b_exp').val(\"B\");\n      $('#preset-modal').modal('hide');\n      options.save_infragrammar_inputs();\n      if (options.webGlSupported) {\n        return glHandleOnClickRaw();\n      } else {\n        return options.run_infragrammar(options.mode);\n      }\n    });\n\n    $(\"#preset_ndvi_blue\").click(function() {\n      $('#modeSwitcher').val(\"infragrammar_mono\").change();\n      $('#m_exp').val(\"(R-B)/(R+B)\");\n      $('#preset-modal').modal('hide');\n      options.save_infragrammar_inputs();\n      if (options.webGlSupported) {\n        return glHandleOnSubmitInfraMono();\n      } else {\n        return options.run_infragrammar(options.mode);\n      }\n    });\n\n    $(\"#preset_ndvi_blue_color\").click(function() {\n      $('#modeSwitcher').val(\"infragrammar_mono\").change();\n      $('#m_exp').val(\"(R-B)/(R+B)\");\n      $('#preset-modal').modal('hide');\n      options.save_infragrammar_inputs();\n      if (options.webGlSupported) {\n        glHandleOnClickColor();\n        return glHandleOnClickNdvi();\n      } else {\n        options.colorized = true;\n        options.run_infragrammar(options.mode);\n        return options.run_colorize();\n      }\n    });\n\n    $(\"#preset_ndvi_red\").click(function() {\n      $('#modeSwitcher').val(\"infragrammar_mono\").change();\n      $('#m_exp').val(\"(B-R)/(B+R)\");\n      $('#preset-modal').modal('hide');\n      options.save_infragrammar_inputs();\n      if (options.webGlSupported) {\n        return glHandleOnSubmitInfraMono();\n      } else {\n        return options.run_infragrammar(options.mode);\n      }\n    });\n\n    $(\"#preset_ndvi_red_color\").click(function() {\n      $('#modeSwitcher').val(\"infragrammar_mono\").change();\n      $('#m_exp').val(\"(B-R)/(B+R)\");\n      $('#preset-modal').modal('hide');\n      options.save_infragrammar_inputs();\n      if (options.webGlSupported) {\n        glHandleOnClickColor();\n        return glHandleOnClickNdvi();\n      } else {\n        options.colorized = true;\n        options.run_infragrammar(options.mode);\n        return options.run_colorize();\n      }\n    });\n\n    $(\"#btn-colorize\").click(function() {\n      if (options.webGlSupported) {\n        glHandleOnClickColor();\n        return glHandleOnClickNdvi();\n      } else {\n        options.colorized = true;\n        options.run_infragrammar(options.mode);\n        return options.run_colorize();\n      }\n    });\n\n    $(\"#default_colormap\").click(function() {\n      var colormap;\n      if (options.webGlSupported) {\n        glhandledefaultcolormap();\n        glhandleonclickndvi();\n      } else {\n        options.colorized = true;\n        colormap = Colormaps.colormap1;\n        options.run_colorize();\n      }\n      return $(\"#btn-colorize\").addClass(\"active\");\n    });\n\n    $(\"#stretched_colormap\").click(function() {\n      var colormap;\n      if (options.webGlSupported) {\n        glHandleStretchedColormap();\n        glHandleOnClickNdvi();\n      } else {\n        options.colorized = true;\n        colormap = Colormaps.colormap2;\n        options.run_colorize();\n      }\n      return $(\"#btn-colorize\").addClass(\"active\");\n    });\n\n    $(\"button#raw\").click(function() {\n      logger.log.push(\"mode=raw\");\n      if (options.webGlSupported) {\n        glHandleOnClickRaw();\n      } else {\n        jsHandleOnClickRaw();\n      }\n      return true;\n    });\n\n    $(\"button#ndvi\").click(function() {\n      logger.log.push(\"mode=ndvi\");\n      if (options.webGlSupported) {\n        glHandleOnClickNdvi();\n      } else {\n        jsHandleOnClickNdvi();\n      }\n      return true;\n    });\n\n    $(\"button#nir\").click(function() {\n      logger.log.push(\"mode=nir\");\n      $(\"#m_exp\").val(\"R\");\n      $(\"#modeSwitcher\").val(\"infragrammar_mono\").change();\n      if (options.webGlSupported) {\n        glHandleOnSubmitInfraMono();\n      } else {\n        jsHandleOnSubmitInfraMono();\n      }\n      return true;\n    });\n    $(\"#download\").click(function() {\n      downloadImage();\n      return true;\n    });\n\n    $(\"#save\").click(function() {\n      var img, sendThumbnail;\n      sendThumbnail = function() {\n        var img;\n        img = getCurrentImage();\n        return FileUpload.uploadThumbnail(img, function() {\n          $(\"#form-filename\").val(FileUpload.getFilename());\n          $(\"#form-log\").val(JSON.stringify(logger.log));\n          return $(\"#save-form\").submit();\n        });\n      };\n      $(\"#save\").prop(\"disabled\", true);\n      $(\"#save\").html(\"Saving...\");\n      if (FileUpload.getFilename() === \"\") {\n        img = getCurrentImage();\n        FileUpload.fromBase64(\"camera\", img, sendThumbnail);\n      } else if (FileUpload.isLoadedFromFile() === false) {\n        FileUpload.duplicate(sendThumbnail);\n      } else {\n        sendThumbnail();\n      }\n      return true;\n    });\n\n    $(\"#infragrammar_hsv\").submit(function() {\n      options.mode = \"infragrammar_hsv\";\n      logger.log_hsv();\n      options.save_infragrammar_inputs();\n      if (options.webGlSupported) {\n        glHandleOnSubmitInfraHsv();\n      } else {\n        options.run_infragrammar(options.mode);\n      }\n      return true;\n    });\n\n    $(\"#infragrammar\").submit(function() {\n      options.mode = \"infragrammar\";\n      logger.log_rgb();\n      options.save_infragrammar_inputs();\n      if (options.webGlSupported) {\n        glHandleOnSubmitInfra();\n      } else {\n        options.run_infragrammar(options.mode);\n      }\n      return true;\n    });\n\n    $(\"#infragrammar_mono\").submit(function() {\n      options.mode = \"infragrammar_mono\";\n      logger.log_mono();\n      options.save_infragrammar_inputs();\n      if (options.webGlSupported) {\n        glHandleOnSubmitInfraMono();\n      } else {\n        options.run_infragrammar(options.mode);\n      }\n      return true;\n    });\n\n    $(\"button#grey\").click(function() {\n      logger.log.push(\"mode=ndvi\");\n      if (options.webGlSupported) {\n        glHandleOnClickGrey();\n      } else {\n        jsHandleOnClickGrey();\n      }\n      return true;\n    });\n\n    $(\"button#colorify\").click(function() {\n      if (options.webGlSupported) {\n        glHandleOnClickColorify();\n      } else {\n        jsHandleOnClickColorify();\n      }\n      return true;\n    });\n\n    $(\"button#color\").click(function() {\n      logger.log.push(\"mode=ndvi&color=true\");\n      if (options.webGlSupported) {\n        glHandleOnClickColor();\n      } else {\n        jsHandleOnClickColor();\n      }\n      return true;\n    });\n\n    $(\"#webgl-activate\").click(function() {\n      var href;\n      href = window.location.href;\n      if (options.webGlSupported) {\n        href = href.replace(/(?:\\?|&)webgl=true/gi, \"\");\n      } else {\n        href += href.indexOf(\"?\") >= 0 ? \"&webgl=true\" : \"?webgl=true\";\n      }\n      window.location.href = href;\n      return true;\n    });\n\n    $(\"#webcam-activate\").click(function() {\n      $(\"#save-modal-btn\").show();\n      $(\"#save-zone\").show();\n      options.camera.initialize();\n      options.save_infragrammar_inputs();\n      if (options.webGlSupported) {\n        setInterval(function() {\n          if (image) {\n            options.run_infragrammar(options.mode);\n          }\n          options.camera.getSnapshot();\n          if (options.colorized) {\n            return options.run_colorize();\n          }\n        }, 33);\n      } else {\n        setInterval(function() {\n          if (image) {\n            options.run_infragrammar(options.mode);\n          }\n          options.camera.getSnapshot();\n          if (options.colorized) {\n            return options.run_colorize();\n          }\n        }, 250);\n      }\n      $('#preset-modal').modal('show');\n      return true;\n    });\n\n    $(\"#snapshot\").click(function() {\n      options.camera.getSnapshot();\n      return true;\n    });\n\n    $(\"#exit-fullscreen\").click(function() {\n      $(\"#image\").css(\"display\", \"inline\");\n      $(\"#image\").css(\"position\", \"relative\");\n      $(\"#image\").css(\"height\", \"auto\");\n      $(\"#image\").css(\"left\", 0);\n      $(\"#backdrop\").hide();\n      $(\"#exit-fullscreen\").hide();\n      $(\"#fullscreen\").show();\n      return true;\n    });\n\n    $(\"#fullscreen\").click(function() {\n      $(\"#image\").css(\"display\", \"block\");\n      $(\"#image\").css(\"height\", \"100%\");\n      $(\"#image\").css(\"width\", \"auto\");\n      $(\"#image\").css(\"position\", \"absolute\");\n      $(\"#image\").css(\"top\", \"0px\");\n      $(\"#image\").css(\"left\", parseInt((window.innerWidth - $(\"#image\").width()) / 2) + \"px\");\n      $(\"#image\").css(\"z-index\", \"2\");\n      $(\"#backdrop\").show();\n      $(\"#exit-fullscreen\").show();\n      $(\"#fullscreen\").hide();\n      return true;\n    });\n\n    $(\"#modeSwitcher\").change(function() {\n      $(\"#infragrammar, #infragrammar_mono, #infragrammar_hsv\").hide();\n      $(\"#\" + $(\"#modeSwitcher\").val()).css(\"display\", \"inline\");\n      return true;\n    });\n\n    $(\"[rel=tooltip]\").tooltip()\n    $(\"[rel=popover]\").popover()\n    return true;\n  });\n}\n\n},{\"./color/colormaps\":3,\"./file-upload\":6,\"urlhash\":1}],8:[function(require,module,exports){\n// This file was adapted from infragram-js:\n// http://github.com/p-v-o-s/infragram-js.\nmodule.exports = function Camera(options) {\n  var canvas, \n      ctx;\n\n  // Initialize getUserMedia with options\n  function initialize() {\n    getUserMedia(webRtcOptions, success, deviceError);\n\n    // iOS Safari 11 compatibility: https://github.com/webrtc/adapter/issues/685\n    webRtcOptions.videoEl.setAttribute('autoplay', 'autoplay');\n    webRtcOptions.videoEl.setAttribute('playsinline', 'playsinline');\n\n    window.webcam = webRtcOptions; // this is weird but maybe used for flash fallback?\n    canvas = options.canvas || document.getElementById(\"image\");\n    ctx = canvas.getContext(\"2d\");\n    // Trigger a snapshot w/ button\n    // -- move this to interface.js?\n    $(\"#webcam-activate\").hide();\n    $(\"#snapshot\").show();\n    $(\"#live-video\").show();\n    $(\"#webcam\").show();\n  }\n\n  // webRtcOptions contains the configuration information for the shim\n  // it allows us to specify the width and height of the video\n  // output we\"re working with, the location of the fallback swf,\n  // events that are triggered onCapture and onSave (for the fallback)\n  // and so on.\n  var webRtcOptions = options.webRtcOptions || {\n    \"audio\": false,\n    \"video\": true,\n    // the element (by id) you wish to use for \n    // displaying the stream from a camera\n    el: \"webcam\",\n    extern: null,\n    append: true,\n    // height and width of the output stream\n    // container\n    width: 640,\n    height: 480,\n    // the recommended mode to be used is \n    // \"callback \" where a callback is executed \n    // once data is available\n    mode: \"callback\",\n    // a debugger callback is available if needed\n    debug: function() {},\n    // callback for capturing the fallback stream\n    onCapture: function onWebRtcCapture() {\n      return window.webcam.save();\n    },\n    // callback for saving the stream, useful for\n    // relaying data further.\n    onSave: onSaveGetUserMedia,\n    onLoad: function onLoadGetUserMedia() {}\n  }\n\n  function onSaveGetUserMedia(data) {\n    var col, h, i, img, j, ref, tmp, w, pos = 0;\n    col = data.split(\"\");\n    img = camera.image;\n    tmp = null;\n    w = webRtcOptions.width;\n    h = webRtcOptions.height;\n    for (i = j = 0, ref = w - 1; 0 <= ref ? j <= ref : j >= ref; i = 0 <= ref ? ++j : --j) {\n      tmp = parseInt(col[i], 10);\n      img.data[pos + 0] = (tmp >> 16) & 0xff;\n      img.data[pos + 1] = (tmp >> 8) & 0xff;\n      img.data[pos + 2] = tmp & 0xff;\n      img.data[pos + 3] = 0xff;\n      pos += 4;\n    }\n    if (pos >= 4 * w * h) {\n      ctx.putImageData(img, 0, 0);\n      return pos = 0;\n    }\n  }\n\n  function success(stream) {\n    var vendorURL, video;\n    if (webRtcOptions.context === \"webrtc\") {\n      video = webRtcOptions.videoEl;\n      vendorURL = window.URL || window.webkitURL;\n      if (navigator.mozGetUserMedia) {\n        video.mozSrcObject = stream;\n        console.log(\"mozilla???\");\n      } else {\n        video.src = vendorURL ? vendorURL.createObjectURL(stream) : stream;\n      }\n      return video.onerror = function(e) {\n        return stream.stop();\n      }\n    } else {\n\n    }\n  }\n\n  function deviceError(error) {\n    alert(\"No camera available.\");\n    console.log(error);\n    return console.error(\"An error occurred: [CODE \" + error.code + \"]\");\n  }\n\n  // not doing anything now... for copying to a 2nd canvas\n  function getSnapshot() {\n    var video;\n    // If the current context is WebRTC/getUserMedia (something\n    // passed back from the shim to avoid doing further feature\n    // detection), we handle getting video/images for our canvas \n    // from our HTML5 <video> element.\n    if (webRtcOptions.context === \"webrtc\") {\n      video = document.getElementsByTagName(\"video\")[0];\n      options.processor.updateImage(video);\n      return $(\"#webcam\").hide();\n    // Otherwise, if the context is Flash, we ask the shim to\n    // directly call window.webcam, where our shim is located\n    // and ask it to capture for us.\n    } else if (webRtcOptions.context === \"flash\") {\n      return window.webcam.capture();\n    } else {\n      console.log(\"No context was supplied to getSnapshot()\");\n    }\n  }\n\n  return {\n    getSnapshot: getSnapshot,\n    initialize: initialize,\n    onSaveGetUserMedia: onSaveGetUserMedia,\n    webRtcOptions: webRtcOptions\n  }\n}\n\n},{}],9:[function(require,module,exports){\n// refactor to access state, not dom\nmodule.exports = function Logger(options) {\n\n  var log = []; // a record of previous commands run\n\n  function log_mono() {\n    var logEntry;\n    logEntry = \"mode=infragrammar_mono\";\n    logEntry += $(\"#m_exp\").val() ? \"&m=\" + $(\"#m_exp\").val() : \"\";\n    logEntry += options.colorized ? \"&c=true\" : \"\"; // no way to succinctly store the colormap... just offer range of colorizations at view-time?\n    return log.push(logEntry);\n  }\n\n  function log_hsv() {\n    var logEntry;\n    logEntry = \"mode=infragrammar_hsv\";\n    logEntry += $(\"#h_exp\").val() ? \"&h=\" + $(\"#h_exp\").val() : \"\";\n    logEntry += $(\"#s_exp\").val() ? \"&s=\" + $(\"#s_exp\").val() : \"\";\n    logEntry += $(\"#v_exp\").val() ? \"&v=\" + $(\"#v_exp\").val() : \"\";\n    return log.push(logEntry);\n  }\n\n  function log_rgb() {\n    var logEntry;\n    logEntry = \"mode=infragrammar\";\n    logEntry += $(\"#r_exp\").val() ? \"&r=\" + $(\"#r_exp\").val() : \"\";\n    logEntry += $(\"#g_exp\").val() ? \"&g=\" + $(\"#g_exp\").val() : \"\";\n    logEntry += $(\"#b_exp\").val() ? \"&b=\" + $(\"#b_exp\").val() : \"\";\n    return log.push(logEntry);\n  }\n\n  function save_log() {\n    if (options.mode === \"infragrammar_mono\") {\n      return log_mono();\n    } else if (options.mode === \"infragrammar_hsv\") {\n      return log_hsv();\n    } else if (options.mode === \"infragrammar\") {\n      return log_rgb();\n    }\n  }\n\n  return {\n    log: log,\n    log_hsv: log_hsv,\n    log_mono: log_mono,\n    log_rgb: log_rgb,\n    save_log: save_log\n  }\n\n}\n\n},{}],10:[function(require,module,exports){\n// This file was adapted from infragram-js:\n// http://github.com/p-v-o-s/infragram-js.\n\nmodule.exports = function javascriptProcessor() {\n\n  var b_exp = \"\",\n      g_exp = \"\",\n      get_channels,\n      Colormaps = require('../color/colormaps')(),\n      colormap = Colormaps.colormap1,\n      converters = require('../color/converters'),\n      image = null,\n      jsHandleOnClickGrey,\n      jsHandleOnClickNdvi,\n      jsHandleOnClickRaw,\n      jsHandleOnSlide,\n      jsHandleOnSubmitInfra,\n      jsHandleOnSubmitInfraHsv,\n      jsHandleOnSubmitInfraMono,\n      m_exp = \"\",\n      mode = \"raw\",\n      ndvi,\n      r_exp = \"\",\n      set_mode,\n      update_colorbar;\n\n  function histogram(array, [min, max], nbins) {\n    var a, bins, d, i, l, len;\n    bins = (function() {\n      var l, ref, results;\n      results = [];\n      for (i = l = 0, ref = nbins; 0 <= ref ? l < ref : l > ref; i = 0 <= ref ? ++l : --l) {\n        results.push(0);\n      }\n      return results;\n    })();\n    d = (max - min) / nbins;\n    for (l = 0, len = array.length; l < len; l++) {\n      a = array[l];\n      i = Math.floor((a - min) / d);\n      if ((0 <= i && i < nbins)) {\n        bins[i]++;\n      }\n    }\n    return bins;\n  }\n\n  function get_channels(jsImage) {\n    var b, g, i, l, mkImage, n, r, ref;\n    n = jsImage.width * jsImage.height;\n    r = new Float32Array(n);\n    g = new Float32Array(n);\n    b = new Float32Array(n);\n    for (i = l = 0, ref = n; 0 <= ref ? l < ref : l > ref; i = 0 <= ref ? ++l : --l) {\n      r[i] = jsImage.data[4 * i + 0];\n      g[i] = jsImage.data[4 * i + 1];\n      b[i] = jsImage.data[4 * i + 2];\n    }\n    function mkImage(d) {\n      return new JsImage(d, jsImage.width, jsImage.height, 1);\n    }\n    return [mkImage(r), mkImage(g), mkImage(b)];\n  }\n\n  // replace with infragrammar expression\n  function ndvi(nirJsImg, visJsImg) {\n    var d, i, l, n, ref;\n    n = nirJsImg.width * nirJsImg.height;\n    d = new Float64Array(n);\n    for (i = l = 0, ref = n; 0 <= ref ? l < ref : l > ref; i = 0 <= ref ? ++l : --l) {\n      d[i] = (nirJsImg.data[i] - visJsImg.data[i]) / (nirJsImg.data[i] + visJsImg.data[i]);\n    }\n    return new JsImage(d, nirJsImg.width, nirJsImg.height, 1);\n  }\n\n  function infragrammar(jsImage) {\n    var b, g, i, l, n, o, r, ref;\n    $('#btn-colorize').removeClass('active');\n    n = jsImage.width * jsImage.height;\n    r = new Float32Array(n);\n    g = new Float32Array(n);\n    b = new Float32Array(n);\n    o = new Float32Array(4 * n);\n    for (i = l = 0, ref = n; 0 <= ref ? l < ref : l > ref; i = 0 <= ref ? ++l : --l) {\n      r[i] = jsImage.data[4 * i + 0] / 255;\n      g[i] = jsImage.data[4 * i + 1] / 255;\n      b[i] = jsImage.data[4 * i + 2] / 255;\n      o[4 * i + 0] = 255 * r_exp(r[i], g[i], b[i]);\n      o[4 * i + 1] = 255 * g_exp(r[i], g[i], b[i]);\n      o[4 * i + 2] = 255 * b_exp(r[i], g[i], b[i]);\n      o[4 * i + 3] = 255;\n    }\n    return new JsImage(o, jsImage.width, jsImage.height, 4);\n  }\n\n  function infragrammar_mono(jsImage) {\n    var b, g, i, l, n, o, r, ref;\n    n = jsImage.width * jsImage.height;\n    r = new Float32Array(n);\n    g = new Float32Array(n);\n    b = new Float32Array(n);\n    o = new Float32Array(n);\n    for (i = l = 0, ref = n; 0 <= ref ? l < ref : l > ref; i = 0 <= ref ? ++l : --l) {\n      r[i] = jsImage.data[4 * i + 0] / 255.0;\n      g[i] = jsImage.data[4 * i + 1] / 255.0;\n      b[i] = jsImage.data[4 * i + 2] / 255.0;\n      o[i] = r_exp(r[i], g[i], b[i]);\n    }\n    return new JsImage(o, jsImage.width, jsImage.height, 1);\n  }\n\n  function render(jsImage) {\n    var ctx, d, e;\n    e = $(\"#image\")[0];\n    e.width = jsImage.width;\n    e.height = jsImage.height;\n    ctx = e.getContext(\"2d\");\n    d = ctx.getImageData(0, 0, jsImage.width, jsImage.height);\n    jsImage.copyToImageData(d);\n    return ctx.putImageData(d, 0, 0);\n  }\n\n  update_colorbar = (min, max) => {\n    var b, ctx, d, e, g, i, j, k, l, m, r, ref, ref1;\n    $('#colorbar-container')[0].style.display = 'inline-block';\n    e = $('#colorbar')[0];\n    ctx = e.getContext(\"2d\");\n    d = ctx.getImageData(0, 0, e.width, e.height);\n    for (i = l = 0, ref = e.width; 0 <= ref ? l < ref : l > ref; i = 0 <= ref ? ++l : --l) {\n      for (j = m = 0, ref1 = e.height; 0 <= ref1 ? m < ref1 : m > ref1; j = 0 <= ref1 ? ++m : --m) {\n        [r, g, b] = colormap(i / e.width);\n        k = 4 * (i + j * e.width);\n        d.data[k + 0] = r;\n        d.data[k + 1] = g;\n        d.data[k + 2] = b;\n        d.data[k + 3] = 255;\n      }\n    }\n    ctx.putImageData(d, 0, 0);\n    $(\"#colorbar-min\")[0].textContent = min.toFixed(2);\n    return $(\"#colorbar-max\")[0].textContent = max.toFixed(2);\n  }\n\n  function update(image) {\n    var b, g, max, min, ndvi_jsImg, normalize, r, resultJsImage;\n    $('#colorbar-container')[0].style.display = 'none';\n    if (mode === \"ndvi\") {\n      [r, g, b] = get_channels(image);\n      ndvi_jsImg = ndvi(r, b);\n      // this isn't correct for NDVI; we want values from -1 to 1:\n      // [[min],[max]] = ndvi_img.extrema()\n      min = -1;\n      max = 1;\n      function normalize(x) {\n        return (x - min) / (max - min);\n      };\n      resultJsImage = Colormaps.colorify(ndvi_jsImg, function(x) {\n        return colormap(normalize(x));\n      });\n      update_colorbar(min, max);\n    } else if (mode === \"raw\") {\n      resultJsImage = new JsImage(image.data, image.width, image.height, 4);\n    } else if (mode === \"nir\") {\n      [r, g, b] = get_channels(image);\n      resultJsImage = Colormaps.colorify(r, function(x) {\n        return [x, x, x];\n      });\n    } else {\n      resultJsImage = infragrammar(image);\n    }\n    return render(resultJsImage);\n  }\n\n  function save_expressions(r, g, b) {\n    if (r === \"\") {\n      r = \"R\";\n    }\n    if (g === \"\") {\n      g = \"G\";\n    }\n    if (b === \"\") {\n      b = \"B\";\n    }\n    eval(\"r_exp = function(R,G,B){var r=R,g=G,b=B;return \" + r + \";}\");\n    eval(\"g_exp = function(R,G,B){var r=R,g=G,b=B;return \" + g + \";}\");\n    return eval(\"b_exp = function(R,G,B){var r=R,g=G,b=B;return \" + b + \";}\");\n  };\n\n  save_expressions_hsv = function(h, s, v) {\n    if (h === \"\") {\n      h = \"H\";\n    }\n    if (s === \"\") {\n      s = \"S\";\n    }\n    if (v === \"\") {\n      v = \"V\";\n    }\n    eval(\"r_exp = function(R,G,B){var h=H,s=S,v=V,hsv = converters.rgb2hsv(R, G, B), H = hsv[0], S = hsv[1], V = hsv[2]; return converters.hsv2rgb(\" + h + \",\" + s + \",\" + v + \")[0];}\");\n    eval(\"g_exp = function(R,G,B){var h=H,s=S,v=V,hsv = converters.rgb2hsv(R, G, B), H = hsv[0], S = hsv[1], V = hsv[2]; return converters.hsv2rgb(\" + h + \",\" + s + \",\" + v + \")[1];}\");\n    return eval(\"b_exp = function(R,G,B){var h=H,s=S,v=V,hsv = converters.rgb2hsv(R, G, B), H = hsv[0], S = hsv[1], V = hsv[2]; return converters.hsv2rgb(\" + h + \",\" + s + \",\" + v + \")[2];}\");\n  }\n\n  function getImageData() {\n    var ctx = $('#image')[0].getContext(\"2d\");\n// risks being circular def of width/height\n    var width = $('#image').width();\n    var height = $('#image').height();\n// this now just defaults to file-scoped 'image' which we want to avoid\n    return image || ctx.getImageData(0, 0, width, height);\n  }\n\n  function getJsImage() {\n    var imageData = getImageData();\n    return new JsImage(imageData.data, imageData.width, imageData.height, 1);\n  }\n\n  function set_mode(new_mode) {\n    mode = new_mode;\n    update(getImageData());\n    if (mode === \"ndvi\") {\n      return $(\"#colormaps-group\")[0].style.display = \"inline-block\";\n    } else {\n      if ($(\"#colormaps-group\").size() > 0) {\n        return $(\"#colormaps-group\")[0].style.display = \"none\";\n      }\n    }\n  }\n\n  // img should be a native JavaScript image obj\n  function updateImage(img) {\n    var ctx, height, imgCanvas, width;\n    imgCanvas = document.getElementById(\"image\");\n    ctx = imgCanvas.getContext(\"2d\");\n    width = img.videoWidth || img.width;\n    height = img.videoHeight || img.height;\n    ctx.drawImage(img, 0, 0, width, height, 0, 0, imgCanvas.width, imgCanvas.height);\n    image = ctx.getImageData(0, 0, imgCanvas.width, imgCanvas.height);\n    return set_mode(mode);\n  }\n\n  function runInfragrammar(mode) {\n    return set_mode(mode);\n  }\n\n  function getCurrentImage() {\n    var ctx, e;\n    e = $(\"#image\")[0];\n    ctx = e.getContext(\"2d\");\n    return ctx.canvas.toDataURL(\"image/jpeg\");\n  }\n\n  jsHandleOnClickRaw = function() {\n    return set_mode(\"raw\");\n  }\n\n  jsHandleOnClickNdvi = function() {\n    return set_mode(\"ndvi\");\n  }\n\n  jsHandleOnSubmitInfraHsv = function() {\n    save_expressions_hsv($('#h_exp').val(), $('#s_exp').val(), $('#v_exp').val());\n    return set_mode(\"infragrammar_hsv\");\n  }\n\n  jsHandleOnSubmitInfra = function() {\n    save_expressions($('#r_exp').val(), $('#g_exp').val(), $('#b_exp').val());\n    return set_mode(\"infragrammar\");\n  }\n\n  jsHandleOnSubmitInfraMono = function() {\n    save_expressions($('#m_exp').val(), $('#m_exp').val(), $('#m_exp').val());\n    return set_mode(\"infragrammar_mono\");\n  }\n\n  jsHandleOnClickGrey = function() {\n    colormap = Colormaps.greyscale_colormap;\n    return update(image);\n  }\n\n  return {\n    type: 'javascript',\n    colormap: colormap,\n    getCurrentImage: getCurrentImage,\n    getImageData: getImageData,\n    getJsImage: getJsImage,\n    infragrammar_mono: infragrammar_mono,\n    infragrammar: infragrammar,\n    render: render,\n    runInfragrammar: runInfragrammar,\n    save_expressions: save_expressions,\n    save_expressions_hsv: save_expressions_hsv,\n    update: update,\n    updateImage: updateImage\n  }\n\n}\n\n},{\"../color/colormaps\":3,\"../color/converters\":4}],11:[function(require,module,exports){\n// Generated by CoffeeScript 2.1.0\n// This file was adapted from infragram-js:\n// http://github.com/p-v-o-s/infragram-js.\nmodule.exports = function webglProcessor() {\n\n  var imgContext = null,\n      mapContext = null,\n      vertices = [-1.0, -1.0, -1.0, 1.0, 1.0, -1.0, 1.0, 1.0],\n      waitForShadersToLoad = 0,\n      webglUtils = require('../util/webgl-utils')();\n\n  vertices.itemSize = 2;\n\n\n  function initialize() {\n    imgContext = createContext(\"raw\", 1, 0, 1.0, \"image\");\n    mapContext = createContext(\"raw\", 1, 1, 1.0, \"colorbar\");\n    waitForShadersToLoad = 2;\n    $(\"#shader-vs\").load(\"dist/shader.vert\", glShaderLoaded);\n    $(\"#shader-fs-template\").load(\"dist/shader.frag\", glShaderLoaded);\n    if (imgContext && mapContext) {\n      return true;\n    } else {\n      return false;\n    }\n  };\n\n  function createBuffer(ctx, data) {\n    var buffer, gl;\n    gl = ctx.gl;\n    buffer = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, buffer);\n    gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(data), gl.STATIC_DRAW);\n    buffer.itemSize = data.itemSize;\n    return buffer;\n  };\n\n  function createTexture(ctx, textureUnit) {\n    var gl, texture;\n    gl = ctx.gl;\n    texture = gl.createTexture();\n    gl.activeTexture(textureUnit);\n    gl.bindTexture(gl.TEXTURE_2D, texture);\n    gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, true);\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, ctx.canvas.width, ctx.canvas.height, 0, gl.RGBA, gl.UNSIGNED_BYTE, null);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n    return texture;\n  };\n\n  function createContext(mode, selColormap, colormap, slider, canvasName) {\n    var ctx;\n    ctx = new Object();\n    ctx.mode = mode;\n    ctx.expression = [\"\", \"\", \"\"];\n    ctx.selColormap = selColormap;\n    ctx.colormap = colormap;\n    ctx.slider = slider;\n    ctx.updateShader = true;\n    ctx.canvas = document.getElementById(canvasName);\n    ctx.canvas.addEventListener(\"webglcontextlost\", (function(event) {\n      return event.preventDefault();\n    }), false);\n    ctx.canvas.addEventListener(\"webglcontextrestored\", glRestoreContext, false);\n    ctx.gl = webglUtils.getWebGLContext(ctx.canvas);\n    if (ctx.gl) {\n      ctx.gl.getExtension(\"OES_texture_float\");\n      ctx.vertexBuffer = createBuffer(ctx, vertices);\n      ctx.framebuffer = ctx.gl.createFramebuffer();\n      ctx.imageTexture = createTexture(ctx, ctx.gl.TEXTURE0);\n      return ctx;\n    } else {\n      return null;\n    }\n  };\n\n  function drawScene(ctx, returnImage) {\n    var gl, pColormap, pHsvUniform, pNdviUniform, pSampler, pSelColormapUniform, pSliderUniform, pVertexPosition;\n    if (!returnImage) {\n      window.requestAnimationFrame(function() {\n //     webglUtils.requestAnimFrame(function() {\n        return drawScene(ctx, false);\n      });\n    }\n    if (ctx.updateShader) {\n      ctx.updateShader = false;\n      generateShader(ctx);\n    }\n    gl = ctx.gl;\n    gl.viewport(0, 0, ctx.canvas.width, ctx.canvas.height);\n    gl.useProgram(ctx.shaderProgram);\n    gl.bindBuffer(gl.ARRAY_BUFFER, ctx.vertexBuffer);\n    pVertexPosition = gl.getAttribLocation(ctx.shaderProgram, \"aVertexPosition\");\n    gl.enableVertexAttribArray(pVertexPosition);\n    gl.vertexAttribPointer(pVertexPosition, ctx.vertexBuffer.itemSize, gl.FLOAT, false, 0, 0);\n    pSampler = gl.getUniformLocation(ctx.shaderProgram, \"uSampler\");\n    gl.uniform1i(pSampler, 0);\n    pSliderUniform = gl.getUniformLocation(ctx.shaderProgram, \"uSlider\");\n    gl.uniform1f(pSliderUniform, ctx.slider);\n    pNdviUniform = gl.getUniformLocation(ctx.shaderProgram, \"uNdvi\");\n    gl.uniform1i(pNdviUniform, (ctx.mode === \"ndvi\" || ctx.colormap ? 1 : 0));\n    pSelColormapUniform = gl.getUniformLocation(ctx.shaderProgram, \"uSelectColormap\");\n    gl.uniform1i(pSelColormapUniform, ctx.selColormap);\n    pHsvUniform = gl.getUniformLocation(ctx.shaderProgram, \"uHsv\");\n    gl.uniform1i(pHsvUniform, (ctx.mode === \"hsv\" ? 1 : 0));\n    pColormap = gl.getUniformLocation(ctx.shaderProgram, \"uColormap\");\n    gl.uniform1i(pColormap, (ctx.colormap ? 1 : 0));\n    gl.drawArrays(gl.TRIANGLE_STRIP, 0, vertices.length / vertices.itemSize);\n    if (returnImage) {\n      return ctx.canvas.toDataURL(\"image/jpeg\");\n    }\n  };\n\n  function generateShader(ctx) {\nconsole.log('generateShader');\n    var b, code, g, r;\n    [r, g, b] = ctx.expression;\n    // Map HSV to shader variable names\n    r = r.toLowerCase().replace(/h/g, \"r\").replace(/s/g, \"g\").replace(/v/g, \"b\");\n    g = g.toLowerCase().replace(/h/g, \"r\").replace(/s/g, \"g\").replace(/v/g, \"b\");\n    b = b.toLowerCase().replace(/h/g, \"r\").replace(/s/g, \"g\").replace(/v/g, \"b\");\n    // Sanitize strings\n    r = r.replace(/[^xrgb\\/\\-\\+\\*\\(\\)\\.0-9]*/g, \"\");\n    g = g.replace(/[^xrgb\\/\\-\\+\\*\\(\\)\\.0-9]*/g, \"\");\n    b = b.replace(/[^xrgb\\/\\-\\+\\*\\(\\)\\.0-9]*/g, \"\");\n    // Convert int to float\n    r = r.replace(/([0-9])([^\\.])?/g, \"$1.0$2\");\n    g = g.replace(/([0-9])([^\\.])?/g, \"$1.0$2\");\n    b = b.replace(/([0-9])([^\\.])?/g, \"$1.0$2\");\n    if (ctx.mode === \"ndvi\") {\n      if (r !== \"\") {\n        r = \"((\" + r + \") + 1.0) / 2.0\";\n      }\n      if (g !== \"\") {\n        g = \"((\" + g + \") + 1.0) / 2.0\";\n      }\n      if (b !== \"\") {\n        b = \"((\" + b + \") + 1.0) / 2.0\";\n      }\n    }\n    if (r === \"\") {\n      r = \"r\";\n    }\n    if (g === \"\") {\n      g = \"g\";\n    }\n    if (b === \"\") {\n      b = \"b\";\n    }\n    code = $(\"#shader-fs-template\").html();\n    code = code.replace(/@1@/g, r);\n    code = code.replace(/@2@/g, g);\n    code = code.replace(/@3@/g, b);\n    $(\"#shader-fs\").html(code);\n    return ctx.shaderProgram = webglUtils.createProgramFromScripts(ctx.gl, [\"shader-vs\", \"shader-fs\"]);\n  };\n\n  function setMode(ctx, newMode) {\nconsole.log('setMode', newMode);\n    if (ctx.mode != newMode) ctx.updateShader = true;\n    ctx.mode = newMode;\n    if (ctx.mode === \"ndvi\") {\n      $(\"#colorbar-container\")[0].style.display = \"inline-block\";\n      return $(\"#colormaps-group\")[0].style.display = \"inline-block\";\n    } else {\n      $(\"#colorbar-container\")[0].style.display = \"none\";\n      return $(\"#colormaps-group\")[0].style.display = \"none\";\n    }\n  };\n\n  function glShaderLoaded() {\n    waitForShadersToLoad -= 1;\n    if (!waitForShadersToLoad) {\n      drawScene(imgContext);\n      return drawScene(mapContext);\n    }\n  };\n\n  function glRestoreContext() {\n    var imageData;\n    imageData = imgContext.imageData;\n    imgContext = createContext(imgContext.mode, imgContext.selColormap, imgContext.colormap, imgContext.slider, \"image\");\n    mapContext = createContext(mapContext.mode, mapContext.selColormap, mapContext.colormap, mapContext.slider, \"colorbar\");\n    if (imgContext && mapContext) {\n      return updateImage(imageData);\n    }\n  };\n\n  function updateImage(img) {\n    var gl;\n    gl = imgContext.gl;\n    imgContext.imageData = img;\n    gl.activeTexture(gl.TEXTURE0);\n    return gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, img);\n  };\n\n  function getCurrentImage() {\n    return drawScene(imgContext, true);\n  };\n\n  function getImageData() {\n    return imgContext.imageData;\n  };\n\n  function glHandleDefaultColormap() {\n    return imgContext.selColormap = mapContext.selColormap = 0;\n  };\n\n  function glHandleStretchedColormap() {\n    return imgContext.selColormap = mapContext.selColormap = 2;\n  };\n\n  function saveExpression(a, b, c) {\n    return imgContext.expression = [a, b, c];\n  };\n\n  function runInfragrammar(mode) {\n    return setMode(imgContext, \"ndvi\");\n  };\n\n  function glHandleOnClickRaw() {\n    return setMode(imgContext, \"raw\");\n  };\n\n  function glHandleOnClickNdvi() {\n    return setMode(imgContext, \"ndvi\");\n  };\n\n  function glHandleOnSubmitInfraHsv() {\n    return setMode(imgContext, \"hsv\");\n  };\n\n  function glHandleOnSubmitInfra() {\n    return setMode(imgContext, \"rgb\");\n  };\n\n  function glHandleOnSubmitInfraMono() {\n    return setMode(imgContext, \"mono\");\n  };\n\n  function glHandleOnClickGrey() {\n    return imgContext.selColormap = mapContext.selColormap = 1;\n  };\n\n  function glHandleOnClickColor() {\n    return imgContext.selColormap = mapContext.selColormap = 0;\n  };\n\n  function glHandleOnSlide(event) {\n    return imgContext.slider = event.value / 100.0;\n  };\n\n  return {\n    type: 'webgl',\n    initialize: initialize,\n    getCurrentImage: getCurrentImage,\n    getImageData: getImageData,\n    runInfragrammar: runInfragrammar,\n    save_expressions: saveExpression,\n    setMode: setMode,\n    updateImage: updateImage,\n    glHandleOnClickColor: glHandleOnClickColor\n  }\n\n}\n\n},{\"../util/webgl-utils\":13}],12:[function(require,module,exports){\nmodule.exports = class JsImage {\n  constructor(data1, width1, height1, channels) {\n    this.data = data1;\n    this.width = width1;\n    this.height = height1;\n    this.channels = channels;\n  }\n\n  copyToImageData(imgData) {\n    return imgData.data.set(this.data);\n  }\n\n  extrema() {\n    var c, i, j, l, m, maxs, mins, n, ref, ref1;\n    n = this.width * this.height;\n    mins = (function() {\n      var l, ref, results;\n      results = [];\n      for (i = l = 0, ref = this.channels; 0 <= ref ? l < ref : l > ref; i = 0 <= ref ? ++l : --l) {\n        results.push(this.data[i]);\n      }\n      return results;\n    }).call(this);\n    maxs = (function() {\n      var l, ref, results;\n      results = [];\n      for (i = l = 0, ref = this.channels; 0 <= ref ? l < ref : l > ref; i = 0 <= ref ? ++l : --l) {\n        results.push(this.data[i]);\n      }\n      return results;\n    }).call(this);\n    j = 0;\n    for (i = l = 0, ref = n; 0 <= ref ? l < ref : l > ref; i = 0 <= ref ? ++l : --l) {\n      for (c = m = 0, ref1 = this.channels; 0 <= ref1 ? m < ref1 : m > ref1; c = 0 <= ref1 ? ++m : --m) {\n        if (this.data[j] > maxs[c]) {\n          maxs[c] = this.data[j];\n        }\n        if (this.data[j] < mins[c]) {\n          mins[c] = this.data[j];\n        }\n        j++;\n      }\n    }\n    return [mins, maxs];\n  }\n\n}\n\n},{}],13:[function(require,module,exports){\n/*\n * Copyright 2012, Gregg Tavares.\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are\n * met:\n *\n *     * Redistributions of source code must retain the above copyright\n * notice, this list of conditions and the following disclaimer.\n *     * Redistributions in binary form must reproduce the above\n * copyright notice, this list of conditions and the following disclaimer\n * in the documentation and/or other materials provided with the\n * distribution.\n *     * Neither the name of Gregg Tavares. nor the names of his\n * contributors may be used to endorse or promote products derived from\n * this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n * \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n// These funcitions are meant solely to help unclutter the tutorials.\n// They are not meant as production type functions.\n\n// This file was adapted from the above author for Node.js use.\n\nmodule.exports = function webglUtils() {\n\n/**\n * Wrapped logging function.\n * @param {string} msg The message to log.\n */\nvar log = function(msg) {\n  if (window.console && window.console.log) {\n    window.console.log(msg);\n  }\n};\n\n/**\n * Wrapped logging function.\n * @param {string} msg The message to log.\n */\nvar error = function(msg) {\n  if (window.console) {\n    if (window.console.error) {\n      window.console.error(msg);\n    }\n    else if (window.console.log) {\n      window.console.log(msg);\n    }\n  }\n};\n\n/**\n * Turn off all logging.\n */\nvar loggingOff = function() {\n  log = function() {};\n  error = function() {};\n};\n\n/**\n * Check if the page is embedded.\n * @return {boolean} True of we are in an iframe\n */\nvar isInIFrame = function() {\n  return window != window.top;\n};\n\n/**\n * Converts a WebGL enum to a string\n * @param {!WebGLContext} gl The WebGLContext to use.\n * @param {number} value The enum value.\n * @return {string} The enum as a string.\n */\nvar glEnumToString = function(gl, value) {\n  for (var p in gl) {\n    if (gl[p] == value) {\n      return p;\n    }\n  }\n  return \"0x\" + value.toString(16);\n};\n\n/**\n * Creates the HTLM for a failure message\n * @param {string} canvasContainerId id of container of th\n *        canvas.\n * @return {string} The html.\n */\nvar makeFailHTML = function(msg) {\n  return '' +\n    '<table style=\"background-color: #8CE; width: 100%; height: 100%;\"><tr>' +\n    '<td align=\"center\">' +\n    '<div style=\"display: table-cell; vertical-align: middle;\">' +\n    '<div style=\"\">' + msg + '</div>' +\n    '</div>' +\n    '</td></tr></table>';\n};\n\n/**\n * Mesasge for getting a webgl browser\n * @type {string}\n */\nvar GET_A_WEBGL_BROWSER = '' +\n  'This page requires a browser that supports WebGL.<br/>' +\n  '<a href=\"http://get.webgl.org\">Click here to upgrade your browser.</a>';\n\n/**\n * Mesasge for need better hardware\n * @type {string}\n */\nvar OTHER_PROBLEM = '' +\n  \"It doesn't appear your computer can support WebGL.<br/>\" +\n  '<a href=\"http://get.webgl.org/troubleshooting/\">Click here for more information.</a>';\n\n/**\n * Creates a webgl context. If creation fails it will\n * change the contents of the container of the <canvas>\n * tag to an error message with the correct links for WebGL.\n * @param {Element} canvas. The canvas element to create a\n *     context from.\n * @param {WebGLContextCreationAttirbutes} opt_attribs Any\n *     creation attributes you want to pass in.\n * @return {WebGLRenderingContext} The created context.\n */\nvar setupWebGL = function(canvas, opt_attribs) {\n  function showLink(str) {\n    var container = canvas.parentNode;\n    if (container) {\n      container.innerHTML = makeFailHTML(str);\n    }\n  };\n\n  if (!window.WebGLRenderingContext) {\n    //showLink(GET_A_WEBGL_BROWSER);\n    return null;\n  }\n\n  var context = create3DContext(canvas, opt_attribs);\n  if (!context) {\n    //showLink(OTHER_PROBLEM);\n  }\n  return context;\n};\n\n/**\n * Creates a webgl context.\n * @param {!Canvas} canvas The canvas tag to get context\n *     from. If one is not passed in one will be created.\n * @return {!WebGLContext} The created context.\n */\nvar create3DContext = function(canvas, opt_attribs) {\n  var names = [\"webgl\", \"experimental-webgl\"];\n  var context = null;\n  for (var ii = 0; ii < names.length; ++ii) {\n    try {\n      context = canvas.getContext(names[ii], opt_attribs);\n    } catch(e) {}\n    if (context) {\n      break;\n    }\n  }\n  return context;\n}\n\nvar updateCSSIfInIFrame = function() {\n  if (isInIFrame()) {\n    document.body.className = \"iframe\";\n  }\n};\n\n/**\n * Gets a WebGL context.\n * makes its backing store the size it is displayed.\n */\nvar getWebGLContext = function(canvas, opt_attribs) {\n  if (isInIFrame()) {\n    updateCSSIfInIFrame();\n\n    // make the canvas backing store the size it's displayed.\n    canvas.width = canvas.clientWidth;\n    canvas.height = canvas.clientHeight;\n  }\n\n  var gl = setupWebGL(canvas, opt_attribs);\n  return gl;\n};\n\n/**\n * Loads a shader.\n * @param {!WebGLContext} gl The WebGLContext to use.\n * @param {string} shaderSource The shader source.\n * @param {number} shaderType The type of shader.\n * @param {function(string): void) opt_errorCallback callback for errors.\n * @return {!WebGLShader} The created shader.\n */\nvar loadShader = function(gl, shaderSource, shaderType, opt_errorCallback) {\n  var errFn = opt_errorCallback || error;\n  // Create the shader object\n  var shader = gl.createShader(shaderType);\n\n  // Load the shader source\n  gl.shaderSource(shader, shaderSource);\n\n  // Compile the shader\n  gl.compileShader(shader);\n\n  // Check the compile status\n  var compiled = gl.getShaderParameter(shader, gl.COMPILE_STATUS);\n  if (!compiled) {\n    // Something went wrong during compilation; get the error\n    lastError = gl.getShaderInfoLog(shader);\n    errFn(\"*** Error compiling shader '\" + shader + \"':\" + lastError);\n    gl.deleteShader(shader);\n    return null;\n  }\n\n  return shader;\n}\n\n/**\n * Creates a program, attaches shaders, binds attrib locations, links the\n * program and calls useProgram.\n * @param {!Array.<!WebGLShader>} shaders The shaders to attach\n * @param {!Array.<string>} opt_attribs The attribs names.\n * @param {!Array.<number>} opt_locations The locations for the attribs.\n * @param {function(string): void) opt_errorCallback callback for errors.\n */\nvar loadProgram = function(\n    gl, shaders, opt_attribs, opt_locations, opt_errorCallback) {\n  var errFn = opt_errorCallback || error;\n  var program = gl.createProgram();\n  for (var ii = 0; ii < shaders.length; ++ii) {\n    gl.attachShader(program, shaders[ii]);\n  }\n  if (opt_attribs) {\n    for (var ii = 0; ii < opt_attribs.length; ++ii) {\n      gl.bindAttribLocation(\n          program,\n          opt_locations ? opt_locations[ii] : ii,\n          opt_attribs[ii]);\n    }\n  }\n  gl.linkProgram(program);\n\n  // Check the link status\n  var linked = gl.getProgramParameter(program, gl.LINK_STATUS);\n  if (!linked) {\n      // something went wrong with the link\n      lastError = gl.getProgramInfoLog (program);\n      errFn(\"Error in program linking:\" + lastError);\n\n      gl.deleteProgram(program);\n      return null;\n  }\n  return program;\n};\n\n/**\n * Loads a shader from a script tag.\n * @param {!WebGLContext} gl The WebGLContext to use.\n * @param {string} scriptId The id of the script tag.\n * @param {number} opt_shaderType The type of shader. If not passed in it will\n *     be derived from the type of the script tag.\n * @param {function(string): void) opt_errorCallback callback for errors.\n * @return {!WebGLShader} The created shader.\n */\nvar createShaderFromScript = function(\n    gl, scriptId, opt_shaderType, opt_errorCallback) {\n  var shaderSource = \"\";\n  var shaderType;\n  var shaderScript = document.getElementById(scriptId);\n  if (!shaderScript) {\n    throw(\"*** Error: unknown script element\" + scriptId);\n  }\n  shaderSource = shaderScript.text;\n\n  if (!opt_shaderType) {\n    if (shaderScript.type == \"x-shader/x-vertex\") {\n      shaderType = gl.VERTEX_SHADER;\n    } else if (shaderScript.type == \"x-shader/x-fragment\") {\n      shaderType = gl.FRAGMENT_SHADER;\n    } else if (shaderType != gl.VERTEX_SHADER && shaderType != gl.FRAGMENT_SHADER) {\n      throw(\"*** Error: unknown shader type\");\n      return null;\n    }\n  }\n\n  return loadShader(\n      gl, shaderSource, opt_shaderType ? opt_shaderType : shaderType,\n      opt_errorCallback);\n};\n\nvar defaultShaderType = [\n  \"VERTEX_SHADER\",\n  \"FRAGMENT_SHADER\"\n];\n\n/**\n * Creates a program from 2 script tags.\n *\n * @param {!WebGLContext} gl The WebGLContext to use.\n * @param {!Array.<string>} shaderScriptIds Array of ids of the\n *        script tags for the shaders. The first is assumed to\n *        be the vertex shader, the second the fragment shader.\n * @param {!Array.<string>} opt_attribs The attribs names.\n * @param {!Array.<number>} opt_locations The locations for the attribs.\n * @param {function(string): void) opt_errorCallback callback for errors.\n * @return {!WebGLProgram} The created program.\n */\nvar createProgramFromScripts = function(\n    gl, shaderScriptIds, opt_attribs, opt_locations, opt_errorCallback) {\n  var shaders = [];\n  for (var ii = 0; ii < shaderScriptIds.length; ++ii) {\n    shaders.push(createShaderFromScript(\n        gl, shaderScriptIds[ii], gl[defaultShaderType[ii]], opt_errorCallback));\n  }\n  return loadProgram(gl, shaders, opt_attribs, opt_locations, opt_errorCallback);\n};\n\n\n// Add your prefix here.\nvar browserPrefixes = [\n  \"\",\n  \"MOZ_\",\n  \"OP_\",\n  \"WEBKIT_\"\n];\n\n/**\n * Given an extension name like WEBGL_compressed_texture_s3tc\n * returns the supported version extension, like\n * WEBKIT_WEBGL_compressed_teture_s3tc\n * @param {string} name Name of extension to look for\n * @return {WebGLExtension} The extension or undefined if not\n *     found.\n */\nvar getExtensionWithKnownPrefixes = function(gl, name) {\n  for (var ii = 0; ii < browserPrefixes.length; ++ii) {\n    var prefixedName = browserPrefixes[ii] + name;\n    var ext = gl.getExtension(prefixedName);\n    if (ext) {\n      return ext;\n    }\n  }\n};\n\n\n/**\n * Resize a canvas to match the size it's displayed.\n * @param {!Canvas} canvas The canvas to resize.\n */\nvar resizeCanvasToDisplaySize = function(canvas) {\n  if (canvas.width != canvas.clientWidth ||\n      canvas.height != canvas.clientHeight) {\n    canvas.width = canvas.clientWidth;\n    canvas.height = canvas.clientHeight;\n  }\n}\n\n/**\n * Provides requestAnimationFrame in a cross browser way.\n */\nvar requestAnimFrame = (function() {\n  return window.requestAnimationFrame ||\n         window.webkitRequestAnimationFrame ||\n         window.mozRequestAnimationFrame ||\n         window.oRequestAnimationFrame ||\n         window.msRequestAnimationFrame ||\n         function(/* function FrameRequestCallback */ callback, /* DOMElement Element */ element) {\n           return window.setTimeout(callback, 1000/60);\n         };\n})();\n\n/**\n * Provides cancelRequestAnimationFrame in a cross browser way.\n */\nvar cancelRequestAnimFrame = (function() {\n  return window.cancelCancelRequestAnimationFrame ||\n         window.webkitCancelRequestAnimationFrame ||\n         window.mozCancelRequestAnimationFrame ||\n         window.oCancelRequestAnimationFrame ||\n         window.msCancelRequestAnimationFrame ||\n         window.clearTimeout;\n})();\n\nreturn {\n  createProgram: loadProgram,\n  createProgramFromScripts: createProgramFromScripts,\n  createShaderFromScriptElement: createShaderFromScript,\n  getWebGLContext: getWebGLContext,\n  updateCSSIfInIFrame: updateCSSIfInIFrame,\n  getExtensionWithKnownPrefixes: getExtensionWithKnownPrefixes,\n  resizeCanvasToDisplaySize: resizeCanvasToDisplaySize,\n  requestAnimFrame: requestAnimFrame,\n  cancelRequestAnimFrame: cancelRequestAnimFrame\n};\n\n};\n\n},{}]},{},[2]);\n"]}